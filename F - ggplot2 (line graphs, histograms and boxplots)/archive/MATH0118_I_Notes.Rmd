---
title: 'MATH 118: Notes I'
author: ' '
subtitle: 'custom colors, labels'
output:
  pdf_document: default
  html_document:
    code_folding: hide
---

Before we start, check out: [https://native-land.ca/](https://native-land.ca/)

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height=3)
```

```{r message=FALSE, warning=FALSE}
#LOAD PACKAGES 
library(tidyverse)
library(kableExtra)

#LOAD DATA SETS
can_lang <- read.csv("https://raw.githubusercontent.com/ttimbers/canlang/master/inst/extdata/can_lang.csv")
```

```{r fig.height=4 }
plot1 <- can_lang %>% 
  filter(most_at_home >0) %>% 
  filter(mother_tongue >0) %>% 
ggplot( aes(x=most_at_home, y=mother_tongue, color=category, shape=category)) +
  geom_point(alpha=0.7) +
  scale_y_log10(name = "Number of Canadians reporting the \n language as their mother tongue",
                labels = scales::comma) + 
  scale_x_log10(name = "Number of Canadians speaking the language \n as their primary language at home",
                labels = scales::comma) +
  theme_minimal() +
  theme(legend.position="bottom")

plot1
```


\newpage

# Adding Labels (all points)

```{r fig.height=5}
plot1 + geom_text(aes(label=language), size=2)
```

Um... a bit messy. 

We could play with `geom_text` options: `nudge_x` and `nudge_y` but realistically this graph is just too crowded for all these labels to make sense on this graph. 

\newpage

Suppose we are only interested in the Cree languages - a dialect of Algonquin languages. There are several listed in this dataset: 

- Plains Cree
- Moose Cree
- Swampy Cree (sometimes divided into Eastern and Western Swampy Cree,  but not in this dataset)
- Woods Cree
- Northern East Cree
- Southern East Cree
- Atikamekw
- Montagnais (Innu)
- Naskapi
- Cree, n.o.s. (not otherwise specified)

See them on a map here: 

![By Noahedits - Own work, CC BY-SA 4.0, https://commons.wikimedia.org/w/index.php?curid=84799257](images/Cree_map.png){width=70%}

As with many aboriginal languages in Canada, there is a loss of the Cree languages among many speakers over the last few centuries. 

\newpage

Let's say we only want to label on the graph the Cree languages on above plot. We need to create a new column which only contains the Cree languages, and is blank for all the other languages. 

# Adding Labels (subset of points)

```{r}
#ifelse(condition, if condition is met do this, else do this)

can_lang <- can_lang %>% 
  mutate(language_cree = ifelse(language == "Plains Cree"|
                                  language =="Moose Cree"|
                                  language == "Swampy Cree"|
                                  language == "Woods Cree"|
                                  language =="Northern East Cree"|
                                  language =="Southern East Cree"|
                                  language=="Atikamekw"|
                                  language == "Montagnais (Innu)"|
                                  language =="Naskapi"|
                                  language=="Cree, n.o.s.",language,""))

#check it out in the can_lang dataset what we have done! 
can_lang %>% 
  slice(120:130) %>% 
  kbl() %>% 
  kable_styling(latex_options="scale_down") %>% 
  kable_styling(latex_options = "HOLD_position")
```


\newpage

## Using `geom_text`

Note that we need to recreate the plot since the dataset `can_lang` has changed (we added column `language_cree`)

```{r fig.height=4}
plot1 <- can_lang %>% 
  filter(most_at_home >0) %>% 
  filter(mother_tongue >0) %>% 
ggplot( aes(x=most_at_home, y=mother_tongue, color=category, shape=category)) +
  geom_point(alpha=0.7) +
  scale_y_log10(name = "Number of Canadians reporting the \n language as their mother tongue",labels = scales::comma) + 
  scale_x_log10(name = "Number of Canadians speaking the language \n as their primary language at home",labels = scales::comma) +
  theme_minimal() +
  theme(legend.position="bottom")

plot1 + geom_text(aes(label=language_cree), size=2)
```

\newpage

## Using `geom_text_repel` (requires `ggrepel` package)

```{r fig.height=5}
library(ggrepel)
plot1 + geom_text_repel(aes(label=language_cree), size=2, color="black", max.overlaps=50) 
```

\newpage

## Using `geom_label_repel` (requires `ggrepel` package)

```{r fig.height=5}
plot1 + geom_label_repel(aes(label=language_cree), size=2, color="black", max.overlaps=50) 
```

\newpage

# Customizing Colors

## Using Custom Colors

```{r fig.height=5}
plot1 +
  scale_color_manual(values=c("darkorange","darkred","steelblue")) + 
  geom_text_repel(aes(label=language_cree), size=2, color="black", max.overlaps=50) 
```

\newpage

## Using Color Brewer

```{r }
library(RColorBrewer)
```

All palettes: 

![](images/colorpalettes.png){height=80%}

\newpage

```{r fig.height=5}
plot1 +
  scale_color_brewer(palette = "Dark2") +
  ggtitle("Customizing colors using ColorBrewer")
```

\newpage

# A Note About Color Blindness

It is important to consider how a color palette will look to people with common forms of color blindness: 

- avoid red-green contrasts
- check your plots with systems that simulate color blindness.

```{r warning=FALSE}
library(colorBlindness)
displayAllColors(brewer.pal(name = "Set1", n = 8))
displayAllColors(c("darkorange","darkred","steelblue"))
```